<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="KusionStack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="KusionStack Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="KusionStack" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="KusionStack changelog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="KusionStack changelog Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="KusionStack changelog JSON Feed"><title data-rh="true">What We Learned From Large-scale Platform Engineering Practices | KusionStack</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kusionstack.io/blog/2022-lean-from-scale-practice"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="What We Learned From Large-scale Platform Engineering Practices | KusionStack"><meta data-rh="true" name="description" content="Abstraction: This paper attempts to expound on the challenges and best practices in the practice of large-scale platform engineering from the perspectives of engineering, programing language, divide-and-conquer, modeling, automation, and collaborative culture. We hope that by sharing the concepts and practices of our platform engineering with more companies and teams, we can make some interesting changes happen together."><meta data-rh="true" property="og:description" content="Abstraction: This paper attempts to expound on the challenges and best practices in the practice of large-scale platform engineering from the perspectives of engineering, programing language, divide-and-conquer, modeling, automation, and collaborative culture. We hope that by sharing the concepts and practices of our platform engineering with more companies and teams, we can make some interesting changes happen together."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-09-16T00:00:00.000Z"><meta data-rh="true" property="article:tag" content="KusionStack,Kusion,Large-scale,Platform Engineering"><link data-rh="true" rel="icon" href="/img/kcl-logo.png"><link data-rh="true" rel="canonical" href="https://kusionstack.io/blog/2022-lean-from-scale-practice"><link data-rh="true" rel="alternate" href="https://kusionstack.io/blog/2022-lean-from-scale-practice" hreflang="en"><link data-rh="true" rel="alternate" href="https://kusionstack.io/zh-CN/blog/2022-lean-from-scale-practice" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://kusionstack.io/blog/2022-lean-from-scale-practice" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://RE5E6BQUZV-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.59dbafa7.css">
<link rel="preload" href="/assets/js/runtime~main.983d6f0e.js" as="script">
<link rel="preload" href="/assets/js/main.4f869b9e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">⭐️ If you like KusionStack, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/KusionStack/kusion">Github</a></div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/kcl-logo.png" alt="KusionStack Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/kcl-logo.png" alt="KusionStack Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">KusionStack</b></a><a class="navbar__item navbar__link" docid="intro/kusion-intro" href="/docs/user_docs/intro/">UserDoc</a><a class="navbar__item navbar__link" href="/docs/reference/cli/">Reference</a><a class="navbar__item navbar__link" href="/docs/develop/repos">DevDoc</a><a class="navbar__item navbar__link" href="/docs/governance/intro/">Governance</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog/2022-lean-from-scale-practice" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-CN/blog/2022-lean-from-scale-practice" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（中国）</a></li><li><a href="https://github.com/KusionStack/kusionstack.io/issues/25" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><a href="https://github.com/KusionStack" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="searchBox_kyqE"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2022-origin-present-and-future">KusionStack Origin, present and future</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/2022-lean-from-scale-practice">What We Learned From Large-scale Platform Engineering Practices</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2022-sense-of-open-day">KusionStack 开源有感</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2022-open-day">KusionStack Open Day</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/2021-kcl-intro">KCL云原生配置策略语言</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">What We Learned From Large-scale Platform Engineering Practices</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-09-16T00:00:00.000Z" itemprop="datePublished">September 16, 2022</time> · <!-- -->18 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">Xiaodong, Duo</span></div><small class="avatar__subtitle" itemprop="description">Kusion Creator</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p><strong>Abstraction:</strong> This paper attempts to expound on the challenges and best practices in the practice of large-scale platform engineering from the perspectives of engineering, programing language, divide-and-conquer, modeling, automation, and collaborative culture. We hope that by sharing the concepts and practices of our platform engineering with more companies and teams, we can make some interesting changes happen together.</p><p>This article is based on the platform engineering and automation practice of <a href="https://kusionstack.io/docs/user_docs/intro/kusion-intro" target="_blank" rel="noopener noreferrer">KusionStack</a> in Ant Group.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-platform-engineering-making-enterprise-devops-happen">1. Platform Engineering: Making Enterprise DevOps Happen<a class="hash-link" href="#1-platform-engineering-making-enterprise-devops-happen" title="Direct link to heading">​</a></h2><p>The concept of DevOps was proposed more than 10 years ago. From KVM to container to the cloud-native era, a large number of enterprises have invested in the DevOps wave to solve the dilemma of internal large-scale operation efficiency and platform construction efficiency. Most of them have fallen into some kind of Anti-Pattern based on an inappropriate understanding of DevOps, while some companies have explored their golden paths. I have experienced Anti-Patterns as shown in the figure below, where the Dev and Ops teams go their separate ways, or simply force the Dev team to handle Ops work independently. More of the typical classifications can be found <a href="https://web.devopstopologies.com/#anti-types" target="_blank" rel="noopener noreferrer">here</a>.</p><p><img loading="lazy" src="/assets/images/devops-anti-pattern-a9159a518bb8f608b79a505dad7f2aaa.png" width="988" height="410"></p><p>There are various reasons why it is difficult to implement DevOps at scale within the enterprise, especially for companies that maintain their infrastructure within the enterprise while adopting technology platforms on the cloud. Among them, these situations are especially common:</p><ul><li>The dev team and the ops team are in their way due to department walls, lack of insight from leaders, etc., and it is difficult to reach a consensus</li><li>The dev team leaders underestimated the professionalism, complexity and rapid changes of platform and infrastructure technology, operation and reliability work, so that they forced application developers to become experts with a simple DevOps understanding</li><li>The leaders established a DevOps team, but became a middle executor, failing to make the Dev and Ops teams move forward and work closely together</li><li>The platform dev team has an insufficient response to the business complexity brought by the scale and the tech complexity brought by technological evolution, and cannot provide effective support to application developers</li><li>...</li></ul><p>Unlike small teams working on cloud-hosted Infra services and DevOps-as-a-Service products, medium and large enterprises often need to establish an appropriate DevOps system based on their team structure and culture. Judging from the successful cases, whether Meta fully assumes the Ops function by Dev, or Google introduces the SRE team as the middle layer, <a href="https://platformengineering.org/blog/what-is-platform-engineering" target="_blank" rel="noopener noreferrer">Platform Engineering</a> plays a very important role. Platform engineering aims to help enterprises build a self-service operation system for application developers, and try to solve the following key problems through engineering tech means and workflows:</p><ul><li>Design a reasonable abstraction to help application developers reduce the cognitive burden on the delivery, operation, reliability based on Infra, platform and other technologies</li><li>Provide application developers with a unified working interface and space to avoid falling into fragmented product interfaces and complex workflows</li><li>Help developers to carry out work quickly based on <a href="https://internaldeveloperplatform.org/what-is-an-internal-developer-platform/" target="_blank" rel="noopener noreferrer">internal engineering platform</a> through effective workflow and recommended path</li><li>Help developers manage the application life cycle through self-service CI, CD, CDRA products</li><li>Help the platform dev team to open fundamental platform capabilities in a simple, efficient and consistent manner</li><li>Create a culture of collaboration and sharing through training, evangelism, operations, etc.</li></ul><p>The fact is that not everyone should or can be an expert in this field, and it&#x27;s pretty difficult. Even the experts of the platform technology team are usually only good at their professional fields, especially in today&#x27;s wide adoption of cloud-native concepts and technologies, hundreds of thousands of application configurations brought by a large number of highly open and configurable platform technologies, the business complexity of the PaaS field, and the high stability and governance requirements, and the purpose of platform engineering is to allow application developers to participate in such large-scale DevOps work as easily and painlessly as possible. In Ant Group&#x27;s practice, we tend to the following cooperative state, which is closer to Google&#x27;s best practices in team structure and work mode. Platform developers and SREs become &quot;Enablers&quot; to support application developers to complete dev, delivery and operation in self-service. At the same time, the work results of application developers making applications deliverable and operational also become the basis for the ops team to handle application ops work. The SRE, application dev, and ops team periodically feedback the problems and pain points in the work process to the platform dev team to form a positive cycle.</p><p><img loading="lazy" src="/assets/images/devops-cycle-8923aa81a904e40ee30ede0c0d4c16b2.png" width="694" height="666"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-domain-language-a-pole-of-the-engineering-thought">2. Domain Language: A Pole of the Engineering Thought<a class="hash-link" href="#2-domain-language-a-pole-of-the-engineering-thought" title="Direct link to heading">​</a></h2><p>What better way to define an open, self-service, domain-oriented business problem than a domain language that needs to meet the enterprise&#x27;s internal requirements of automation, low-security-risk, low-noise, easy governance? Just as there are staves for recording music, and time-series databases for storing time-series data, within the problem domain of platform engineering, a set of configuration and policy languages ​​are created to write and manage configurations and policies at scale. Different from high-level general-purpose languages ​​with mixed paradigms and engineering capabilities, the core logic of such domain languages ​​is to solve the near-infinite variation and complexity of domain problems with a convergent and limited set of syntax and semantics, and to precipitate the ideas and methods of large-scale complex configuration and policies writing into language features.</p><p>In the platform engineering practice of Ant Group, we have strengthened the client-side working mode. We write and maintain the models, orchestration, constraints and policies around the application ops life cycle in the shared codebase <a href="https://github.com/KusionStack/konfig" target="_blank" rel="noopener noreferrer">Konfig</a> through the record and functional language <a href="https://github.com/KusionStack/KCLVM" target="_blank" rel="noopener noreferrer">KCL</a>. KCL is a static and strongly typed language for application developers with programming ability, providing the writing experience of a modern high-level language with limited functionality around domain purposes. Under such practices, KCL is not a language just for writing K-V pairs, but a language for platform engineering development. Application developers, SREs, and platform developers conduct collaborative dev based on Konfig. They write configurations, and <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#schema" target="_blank" rel="noopener noreferrer">schema</a> abstractions, <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#function" target="_blank" rel="noopener noreferrer">functions</a>, <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#validation" target="_blank" rel="noopener noreferrer">constraints</a> and <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#rule" target="_blank" rel="noopener noreferrer">rules</a> which are frequent and complex in the PaaS field through KCL native functions, that is, write stable and scalable business models, business logic, error-proofing constraints, and environmental rules. The Konfig repository becomes a unified programming interface, workspace and business layer, while the KCL-oriented secure, low-noise, low-side effect and unified writing paradigm are more conducive to long-term management and governance.</p><p><img loading="lazy" src="/assets/images/kcl-dev-f53b8dffa98db3aeba220f1403c6eaed.png" width="1500" height="910"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="3divide-and-conquer-deconstructing-the-scaling-problem">3.Divide and Conquer: Deconstructing the Scaling Problem<a class="hash-link" href="#3divide-and-conquer-deconstructing-the-scaling-problem" title="Direct link to heading">​</a></h2><p>The idea of ​​divide and conquer is the key to solving the problem of scale. From MapReduce to Kubernetes, it all reflects its efficacy. In the field of large-scale delivery and operation, the classic operation platform tries to use the built-in unified model, orchestration, and provision technology in a black-box product to deal with full-scale business scenarios. Such a practice can be started easily and quickly and is effective on a small scale, but as the adoption rate of different business groups increases, differentiated requirements are introduced, and at the same time, with the constantly growing platform technology, it gradually enters a state of fatigue.</p><p><img loading="lazy" src="/assets/images/classic-plats-0e5580742fe5fb7b9d832a1dc235eb36.png" width="1500" height="901"></p><p>In Ant Group&#x27;s practice, Konfig monorepo is the programming workspace opened by the internal engineering platform to developers, helping application developers to write configurations and policies around the application operation life cycle with a unified programming interface and tech stack, to orchestrate existing and new platform and infrastructure, create and manage cloud-native environments and RBAC-based permissions on demand, and manage the delivery workflow through GitOps. Konfig monorepo provides an independent white-box programming space for different scenarios, projects and applications, and its intrinsic scalability comes from:</p><ul><li>Flexible, scalable, independent client-side <a href="https://kusionstack.io/docs/user_docs/concepts/project-stack" target="_blank" rel="noopener noreferrer">engineering structure design</a></li><li>The <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#-operators-1" target="_blank" rel="noopener noreferrer">automatic merging</a> technology of isolated config blocks supports arbitrary and scalable organization of config blocks</li><li><a href="https://kusionstack.io/docs/reference/lang/lang/tour/#type-system" target="_blank" rel="noopener noreferrer">Static type system</a> technology provides reusable and scalable type-based modeling and constraints in a modern programming language manner</li><li>Project-grained Gitops CI workflow definition support (add a link?)</li><li>Provision technology selection based on Kusion engine (add a link?)</li></ul><p>Konfig monorepo provides divide-and-conquer, composable engineering structure design, code organization, modeling, workflow and provision tech selection support, and at the same time, it carries scalable business requirements with a consistent development model and workflow. This way of working on the client side ensures flexibility, scalability, and portability while reducing the pressure on server-side extension mechanisms, such as Kubernetes API Machinery, to continue to grow.</p><p>The following figure illustrates a typical automated workflow with a Gitops approach in the Konfig monorepo, starting from application-oriented code changes and reaching the runtime through configurable CI and CD processes. This mechanism is compared to centralized black-box products. The method is much more open, customizable, and extensible, and it also eliminates the need to design clumsy configuration management portals for different business scenarios, projects, and applications.</p><p><img loading="lazy" alt="image.png" src="/assets/images/d-c-overview-0d3ba9e610b9a7497e5044e7de60124d.png" width="1500" height="985"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-modeling-marginal-revenue-and-the-long-tail">4. Modeling: Marginal Revenue and the Long Tail<a class="hash-link" href="#4-modeling-marginal-revenue-and-the-long-tail" title="Direct link to heading">​</a></h2><p>With the divide-and-conquer white-box engineering structure design, code organization, modeling, workflow and provision tech selection, how to work with platform APIs is another issue that needs to be considered. Typical disputes within the enterprise are between confronting platform details or designing an abstraction or escalating to explicit and implicit concepts.</p><p>The abstract implicit method is a common choice for operation platform engineers for non-expert end users. They hope to design an easy-to-understand and easy-to-use application model or Spec abstraction, which is isolated from specific platform technical details, to reduce end-user cognitive burden, and enhance error proofing by reducing detail perception. However, most operation platform developers tend to design a powerful and unified application model or Spec abstraction. In practice, they often encounter these obstacles:</p><ul><li>With the increasing adoption rate of different business groups within the enterprise, unified modeling is difficult to implement. The most typical case in Ant Group is the huge difference between Infra projects and SaaS applications. Java-based SaaS applications are easy to unify, and Infra applications often need to be designed separately.</li><li>Faced with a large number of platform technologies in the enterprise, the unified model itself is difficult to stabilize, especially in response to continuously changing business needs and platform technology-driven demand growth. In Ant Group&#x27;s practice, delivery and operation requirements are affected by various factors and have strong instability. At the same time, the business requirements for <code>deliverable</code>, <code>runtime</code>, <code>security</code>, and <code>instrumentation</code> around the application operation life cycle are also growing. Taking instrumentation as an example, the rapid growth in demand for application runtime observability and SLO definition in the past two years directly drives changes in end-user usage.</li><li>The common problem of abstract models is that a reasonable model needs to be well designed for end users, and meanwhile, the API details of the platform must be kept in sync.</li></ul><p>In Ant Group&#x27;s practice, we adopt an abstract model for end-users, and application developers, and solve several key problems through the following ideas:</p><ul><li>Modeling for typical applications or scenarios (such as Ant Group&#x27;s Sofa application), these models are developed by platform developers and platform SREs and maintained together with application developers to achieve a balance between user experience, cost and standard compatibility. In Ant Group&#x27;s practice, the information entropy convergence ratio of the abstract model is about 1:5, and the marginal benefit of modeling investment is guaranteed through extensive high-frequency usage.</li><li>For non-typical user applications or scenarios, platform developers and platform SRE support application developers to design application models, and reduce repetitive code by reusing the <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#schema" target="_blank" rel="noopener noreferrer">schema</a> and <a href="https://kusionstack.io/docs/reference/lang/lang/tour#protocol--mixin" target="_blank" rel="noopener noreferrer">mixin</a> structure. A large number of &quot;non-standard&quot; platform applications were managed consistently within Ant Group for the first time, effectively solving the long tail problem. In a typical collaborative mode, platform developers and platform SREs write base components of platform capability to become &quot;Enablers&quot;, which help application developers use base components to quickly &quot;build building blocks&quot; to complete their application models.</li><li>For platform technology, we provide the <a href="https://kusionstack.io/docs/reference/cli/openapi/" target="_blank" rel="noopener noreferrer">generator</a> from platform API Spec to KCL schema code, natively support the compile-time selection of different Kubernetes API versions through <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#multi-file-compilation" target="_blank" rel="noopener noreferrer">combined compilation</a>, and solve the flexible requirements of mapping application models to different versions of Kubernetes clusters in internal practice. At the same time, KCL supports the writing of in-schema <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#validation" target="_blank" rel="noopener noreferrer">constraints</a> and independent environment <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#rule" target="_blank" rel="noopener noreferrer">rules</a>. In addition, KCL also provides the <a href="https://kusionstack.io/docs/reference/lang/lang/tour/#decorators" target="_blank" rel="noopener noreferrer">deprecated decorator</a> to support the force deprecation of the model or model attribute. Through robust and complete modeling and constraint mechanism on the client side, common problems such as configuration errors and schema drift are exposed at compile time. Due to the left-shifted problem found before runtime, runtime errors or failures are avoided when pushing to the cluster. This is also a must-have requirement for the stability of the production environment within an enterprise, especially in a high stability requirements enterprise.</li></ul><p>Expert users of the underlying platform technology, are usually very familiar with a specific technical domain and prefer to work in an explicit way that faces platform details. The KCL language provides the necessary dynamic and modular support and ensures stability through a static type system and constraint mechanisms. However, the explicit method cannot solve the problem that expert users are not familiar with the details of cross-domain platform technologies usage, nor can it solve the problem of the scalability and complexity of platform technologies today. In Ant Group&#x27;s small-scale YAML-based explicit engineering practice, facing a large number of highly open and configurable platform technologies, the complexity continues to accumulate with the utilization rate of platform technologies, and ends up in a rigid state that is hard to read, write, constrain, test, and maintain.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="5-automation-new-challenges">5. Automation: New Challenges<a class="hash-link" href="#5-automation-new-challenges" title="Direct link to heading">​</a></h2><p>Automation is a classic domain in the field of infrastructure operation. With the wide and rapid adoption of cloud-native concepts and technologies, the ability to automatically integrate turns out to be the basic requirement of enterprise operation practice. Open source, highly configurable CI and CD technologies are gradually adopted by enterprises. The black-box &quot;product&quot; approach that cannot be integrated is gradually weakened and replaced by a flexible orchestration approach. The main advantages of this practice lie in its powerful customize orchestration and linking capabilities, high scalability, and good portability. Especially in the Kubernetes ecosystem, the GitOps method has a high adoption rate and has a natural affinity with configurable CI and CD technologies. Such changes are also promoting the gradual transformation of the work order and product centric workflow into a self-service and engineering efficiency platform centric workflow, and the operational capability of the production environment has become an important part of the automatic workflow. In the open source community, the technology innovation of the abstraction layer for different engineering efficiency platforms is also actively in progress. The developers on the platform side hope to get through the CI and CD process applied to the cloud environment through the shortest cognitive and practical path.</p><p>In Ant Group&#x27;s engineering practice, the engineering efficiency platform is deeply involved in the open automation practice of Konfig monorepo, and our practice direction is also highly aligned with the technological roadmap of the engineering efficiency platform. In the collaborative work of several people to dozens to hundreds of people, workflow design for operation scenarios, high-frequency code submission and pipeline execution, real-time automated testing and deployment pose several challenges to the engineering efficiency platform. especially the diverse businesses in monorepo require independent and powerful workflow customization and operation support, as well as parallel workflow execution capabilities with high real-time and strong SLO guarantee. The requirements of the single-repository mode are hugely different and cause us a lot of trouble. Most configuration languages are interpreted languages, while KCL is designed as a compiled language, implemented by Rust, C and LLVM optimizer, to provide high-performance compile-time and runtime execution for large-scale KCL files. At the same time, KCL supports compiling to native code and wasm binary to meet various runtimes execution requirements. In addition, the storage and architecture design of Git is different from the <a href="https://cacm.acm.org/magazines/2016/7/204032-why-google-stores-billions-of-lines-of-code-in-a-single-repository/fulltext" target="_blank" rel="noopener noreferrer">Citc/Piper</a> architecture, and it is not suitable for monorepo of large-scale code. Fortunately, we have not encountered a big problem with the scale of code today. We are working together to solve problems and hope to solve them gradually as the practice deepens.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="6-synergy-and-culture-a-more-important-thing">6. Synergy and Culture: A More Important Thing<a class="hash-link" href="#6-synergy-and-culture-a-more-important-thing" title="Direct link to heading">​</a></h2><p>The above technologies, tools and mechanisms are very important, but I must say that for engineering and DevOps, the more important thing is the culture of collaboration, cooperation and sharing of groups and teams because this is a work composed of people, people and culture is the key point. In an enterprise, if department walls and team barriers are crowded together, and closed and bad engineering culture is popular, we usually see a large number of private code bases and private documents, judgments and working methods with closed small groups, and teams that are supposed to work closely together do their own thing towards their private goals. In a culture like this, I think it&#x27;s going to be very difficult to do anything at scale. So if your company or team wants to adopt DevOps at scale, I think the most important thing is to do broad communication and start building a culture, because it&#x27;s not just a few people&#x27;s businesses, and it&#x27;s very difficult and uncontrollable.</p><p>In Ant Group&#x27;s practice, there are always various difficulties in the initial stage, and everyone&#x27;s concerns about the self-service mechanism and collaborative culture are particularly prominent, such as &quot;I need to write code?&quot; &quot;My code is actually in the same codebase with other teams?&quot;, &quot;The job I&#x27;m in charge of is not easy, it won&#x27;t work this way&quot; are typical concerns. Fortunately, we ended up with a virtual organization for common goals, with full support from partners and leaders, and we agreed on ideas and ways and worked together. In practice, most engineers are not obstacles. Of course, they will complain that the technology, workflow and mechanism are not good enough, and hope to obtain a better user experience, which is understandable. The real obstacle first comes from the operation platform dev team itself. I see that the DevOps ideal of some companies eventually turns to the operation platform team to do all the work for the application developers, and even prevents users from accessing labor tools such as code and toolchains, rushing to bridge it to the existing click ops GUI, I think this goes off the rails and underestimates the capabilities and creativity of the users themselves. The obstacles also come from the technical leaders of some platform technical teams. It is difficult for them to let go of the existing work that has lasted for many years, and it is difficult to accept the transition to a new user service model. The feasible way is to let them understand the meaning and vision of the work, and gradually affect them in stages.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="7-summary">7. Summary<a class="hash-link" href="#7-summary" title="Direct link to heading">​</a></h2><p>After more than a year of practice, 400+ developers have directly participated in the code contribution of Konfig monorepo, and managed more than 1500 projects. Among them, the ratio of platform developers and platform SREs together to application developers is less than 1:9. Some of these application developers are the application owners themselves, and some are representatives of the application dev team, which is up to the application team itself. Through continuous automation capability building, 200-300 commits occur every day based on the Konfig monorepo, most of which are automated code modifications, about 1k pipeline task executions and nearly 10k KCL compilation executions. Today, if you compile the full code in Config once and output it, 300W+ lines of YAML text will be generated. A release operation process requires multiple compilations with different parameter combinations. Through the lightweight and portable code base and toolchains, we have completed a significant external private cloud delivery, eliminating the pain of transforming and porting a series of old operation platforms. Inside Ant Group, we have served several different operation scenarios, and are expanding the scale and exploring more possibilities.</p><p>Finally, I would like to talk about the next step. Our technology and tools still have a lot of room for improvement in terms of usability and user experience. More user feedback and continuous improvement are always needed, and there is no fast path for experience work. In terms of testing, we provide simple integration testing methods, which play the role of smoke testing, but this is not enough. We are trying to ensure correctness based on constraints and rules rather than tests. In terms of work interface, we hope to build an IDE-based dev workspace and continue to enhance and optimize the internal workflow experience. At the same time, we hope to continue to improve coverage and technical capabilities. In addition, we also hope to apply the practice method more widely in CI and operation workflow, and other scenarios, to shorten end-user awareness and end-to-end workflow. At present, KusionStack is still in the very early stage of open source, and there is a lot of work to be done in the future. The most important thing is that we hope to share the concepts and practices of our platform engineering with more companies and teams, to promote and witness some interesting changes together.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="8-reference">8. Reference<a class="hash-link" href="#8-reference" title="Direct link to heading">​</a></h2><ul><li><a href="https://kusionstack.io/docs/user_docs/intro/kusion-intro" target="_blank" rel="noopener noreferrer">https://kusionstack.io/docs/user_docs/intro/kusion-intro</a></li><li><a href="https://platformengineering.org/blog/what-is-platform-engineering" target="_blank" rel="noopener noreferrer">https://platformengineering.org/blog/what-is-platform-engineering</a></li><li><a href="https://internaldeveloperplatform.org/what-is-an-internal-developer-platform/" target="_blank" rel="noopener noreferrer">https://internaldeveloperplatform.org/what-is-an-internal-developer-platform/</a></li><li><a href="https://web.devopstopologies.com/#anti-types" target="_blank" rel="noopener noreferrer">https://web.devopstopologies.com/#anti-types</a></li><li><a href="https://github.com/KusionStack/KCLVM" target="_blank" rel="noopener noreferrer">https://github.com/KusionStack/KCLVM</a></li><li><a href="https://kusionstack.io/docs/reference/lang/lang/tour/#%E9%85%8D%E7%BD%AE%E6%93%8D%E4%BD%9C" target="_blank" rel="noopener noreferrer">https://kusionstack.io/docs/reference/lang/lang/tour</a></li><li><a href="https://kusionstack.io/docs/user_docs/concepts/project-stack" target="_blank" rel="noopener noreferrer">https://kusionstack.io/docs/user_docs/concepts/project-stack</a></li><li><a href="https://cacm.acm.org/magazines/2016/7/204032-why-google-stores-billions-of-lines-of-code-in-a-single-repository/fulltext" target="_blank" rel="noopener noreferrer">https://cacm.acm.org/magazines/2016/7/204032-why-google-stores-billions-of-lines-of-code-in-a-single-repository/fulltext</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/kusion-stack">KusionStack</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/kusion">Kusion</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/large-scale">Large-scale</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/platform-engineering">Platform Engineering</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/KusionStack/kusionstack.io/blob/main/blog/2022-09-16-lean-from-scale-practice/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022-origin-present-and-future"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">KusionStack Origin, present and future</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022-sense-of-open-day"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">KusionStack 开源有感</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-platform-engineering-making-enterprise-devops-happen" class="table-of-contents__link toc-highlight">1. Platform Engineering: Making Enterprise DevOps Happen</a></li><li><a href="#2-domain-language-a-pole-of-the-engineering-thought" class="table-of-contents__link toc-highlight">2. Domain Language: A Pole of the Engineering Thought</a></li><li><a href="#3divide-and-conquer-deconstructing-the-scaling-problem" class="table-of-contents__link toc-highlight">3.Divide and Conquer: Deconstructing the Scaling Problem</a></li><li><a href="#4-modeling-marginal-revenue-and-the-long-tail" class="table-of-contents__link toc-highlight">4. Modeling: Marginal Revenue and the Long Tail</a></li><li><a href="#5-automation-new-challenges" class="table-of-contents__link toc-highlight">5. Automation: New Challenges</a></li><li><a href="#6-synergy-and-culture-a-more-important-thing" class="table-of-contents__link toc-highlight">6. Synergy and Culture: A More Important Thing</a></li><li><a href="#7-summary" class="table-of-contents__link toc-highlight">7. Summary</a></li><li><a href="#8-reference" class="table-of-contents__link toc-highlight">8. Reference</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Document</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/user_docs/intro/kusion-intro">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resource</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/KusionStack" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://KusionStack.slack.com" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/user_docs/support">faq</a></li><li class="footer__item"><a class="footer__link-item" href="/changelog">Changelog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.antgroup.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_RC3H"><img src="/img/oss_logo.svg" alt="AntGroup Open Source Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo" width="160" height="51"><img src="/img/oss_logo.svg" alt="AntGroup Open Source Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo" width="160" height="51"></a></div><div class="footer__copyright">Copyright © 2022 KusionStack Authors</div></div></div></footer></div>
<script src="/assets/js/runtime~main.983d6f0e.js"></script>
<script src="/assets/js/main.4f869b9e.js"></script>
</body>
</html>