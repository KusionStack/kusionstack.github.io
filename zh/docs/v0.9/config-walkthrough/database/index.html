<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v0.9 plugin-docs plugin-id-docs docs-doc-id-config-walkthrough/database" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Managed Databases | Transform Your Internal Developer Platform with KusionStack</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://kusionstack.io/zh/docs/v0.9/config-walkthrough/database"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="v0.9"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-v0.9"><meta data-rh="true" name="docsearch:version" content="v0.9"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-v0.9"><meta data-rh="true" property="og:title" content="Managed Databases | Transform Your Internal Developer Platform with KusionStack"><meta data-rh="true" name="description" content="The database attribute in the AppConfiguration instance is used to describe the specification for any databases needed for the application."><meta data-rh="true" property="og:description" content="The database attribute in the AppConfiguration instance is used to describe the specification for any databases needed for the application."><link data-rh="true" rel="icon" href="/zh/img/kusionstack-icon-square.png"><link data-rh="true" rel="canonical" href="https://kusionstack.io/zh/docs/v0.9/config-walkthrough/database"><link data-rh="true" rel="alternate" href="https://kusionstack.io/docs/v0.9/config-walkthrough/database" hreflang="en"><link data-rh="true" rel="alternate" href="https://kusionstack.io/zh/docs/v0.9/config-walkthrough/database" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kusionstack.io/docs/v0.9/config-walkthrough/database" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Transform Your Internal Developer Platform with KusionStack RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Transform Your Internal Developer Platform with KusionStack Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XC4Z27TLBR"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XC4Z27TLBR",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Transform Your Internal Developer Platform with KusionStack" href="/zh/opensearch.xml"><link rel="stylesheet" href="/zh/assets/css/styles.961cf07e.css">
<link rel="preload" href="/zh/assets/js/runtime~main.76b4a9bd.js" as="script">
<link rel="preload" href="/zh/assets/js/main.6623170c.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">‚≠êÔ∏è If you like KusionStack, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/KusionStack/kusion">Github</a></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/kusionstack-icon.png" alt="KusionStack Icon" class="themedImage_ToTc themedImage--light_HNdA"><img src="/zh/img/kusionstack-icon-white.png" alt="KusionStack Icon" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">KusionStack</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/docs/v0.9/">Kusion</a><a class="navbar__item navbar__link" href="/zh/karpor/">Karpor</a><a class="navbar__item navbar__link" href="/zh/kuperator/introduction/">Kuperator</a><a class="navbar__item navbar__link" href="/zh/ctrlmesh/intro/">Ctrlmesh</a><a class="navbar__item navbar__link" href="/zh/community/intro/">Community</a><a href="https://blog.kusionstack.io" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/docs/v0.9/">v0.9</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/">v0.13 üöß</a></li><li><a class="dropdown__link" href="/zh/docs/">v0.12</a></li><li><a class="dropdown__link" href="/zh/docs/v0.11/">v0.11</a></li><li><a class="dropdown__link" href="/zh/docs/v0.10/">v0.10</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh/docs/v0.9/config-walkthrough/database">v0.9</a></li></ul></div><a href="https://github.com/KusionStack" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-community-current,docs-ctrlmesh-v0.1,docs-karpor-v0.5,docs-docs-v0.9,docs-kuperator-v0.6"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/v0.9/">What is Kusion?</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/v0.9/getting-started/">Getting Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Getting Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/v0.9/concepts/">Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh/docs/v0.9/config-walkthrough/overview">Configuration Walkthrough</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/overview">Configuration File Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/kcl_basics">KCL Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/base_override">Base and Override</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/workload">Workload</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/networking">Application Networking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/database">Managed Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/secret">Secret Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/monitoring">Application Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/v0.9/config-walkthrough/operational_rules">Operational Rules</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/v0.9/guides/">User Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh/docs/v0.9/reference/cli/">Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/zh/docs/v0.9/support/">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Transform Your Internal Developer Platform with KusionStack<!-- --> <b>v0.9</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh/docs/">latest version</a></b> (<!-- -->v0.12<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/zh/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Configuration Walkthrough</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Managed Databases</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v0.9</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Managed Databases</h1><p>The <code>database</code> attribute in the <code>AppConfiguration</code> instance is used to describe the specification for any databases needed for the application.</p><p>You can currently have only one <code>database</code> per <code>AppConfiguration</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="import">Import<a href="#import" class="hash-link" aria-label="Direct link to Import" title="Direct link to Import">‚Äã</a></h2><p>In the examples below, we are using schemas defined in the <code>catalog</code> package. For more details on KCL package import, please refer to the <a href="/zh/docs/v0.9/config-walkthrough/overview">Configuration File Overview</a>.</p><p>The <code>import</code> statements needed for the following walkthrough:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import catalog.models.schema.v1 as ac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import catalog.models.schema.v1.workload as wl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import catalog.models.schema.v1.accessories.database as db</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types-of-database-offerings">Types of Database offerings<a href="#types-of-database-offerings" class="hash-link" aria-label="Direct link to Types of Database offerings" title="Direct link to Types of Database offerings">‚Äã</a></h2><p>As of version 0.9.0, Kusion supports the following database offerings on the cloud:</p><ul><li>Relational Database Service (RDS) on <a href="https://aws.amazon.com/rds/" target="_blank" rel="noopener noreferrer">AWS</a></li><li>Relational Database Service (RDS) on <a href="https://www.alibabacloud.com/product/databases" target="_blank" rel="noopener noreferrer">AliCloud</a></li></ul><p>More database types on more cloud vendors will be added in the future.</p><p>Alternatively, Kusion also supports creating a database at <code>localhost</code> for local testing needs. A local database is quicker to stand up and easier to manage. It also eliminates the need for an account and any relevant costs with the cloud providers in the case that a local testing environment is sufficient.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>You do need a local Kubernetes cluster to run the database workloads. You can refer to <a href="https://minikube.sigs.k8s.io/docs/start/" target="_blank" rel="noopener noreferrer">Minikube</a> or <a href="https://kind.sigs.k8s.io/docs/user/quick-start/" target="_blank" rel="noopener noreferrer">Kind</a> to get started.
To see an end-to-end use case for standing up a local testing environment including a local database, please refer to the <a href="/zh/docs/v0.9/getting-started/deliver-wordpress">Kusion Quickstart</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloud-credentials-and-permissions">Cloud Credentials and Permissions<a href="#cloud-credentials-and-permissions" class="hash-link" aria-label="Direct link to Cloud Credentials and Permissions" title="Direct link to Cloud Credentials and Permissions">‚Äã</a></h2><p>Kusion provisions databases on the cloud via <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">terraform</a> providers. For it to create <em>any</em> cloud resources, it requires a set of credentials that belongs to an account that has the appropriate write access, as well as a provider region so the terraform provider can be initialized properly.</p><p>For AWS, the environment variables needed:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export AWS_ACCESS_KEY_ID=&quot;xxxxxxxxxxx&quot; # replace it with your AccessKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AWS_SECRET_ACCESS_KEY=&quot;xxxxxxx&quot; # replace it with your SecretKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AWS_PROVIDER_REGION=&quot;xx-xxxx-x&quot; # replace it with your AWS Region</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For AliCloud, the environment variables needed:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">export ALICLOUD_ACCESS_KEY=&quot;xxxxxxxxx&quot; # replace it with your AccessKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ALICLOUD_SECRET_KEY=&quot;xxxxxxxxx&quot; # replace it with your SecretKey</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ALICLOUD_PROVIDER_REGION=&quot;xx-xxxxxxx&quot; # replace it with your AliCloud Region</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The user account that owns these credentials would need to have the proper permission policies attached to create databases and security groups. If you are using the cloud-managed policies, the policies needed to provision a database and configure firewall rules are listed below.</p><p>For AWS:</p><ul><li><code>AmazonVPCFullAccess</code> for creating and managing database firewall rules via security group</li><li><code>AmazonRDSFullAccess</code> for creating and managing RDS instances</li></ul><p>For AliCloud:</p><ul><li><code>AliyunVPCFullAccess</code> for creating and managing database firewall rules via security group</li><li><code>AliyunRDSFullAccess</code> for creating and managing RDS instances</li></ul><p>Alternatively, you can use customer managed policies if the cloud provider built-in policies don&#x27;t meet your needs. The list of permissions needed are in the <a href="https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AmazonRDSFullAccess.html#AmazonRDSFullAccess-json" target="_blank" rel="noopener noreferrer">AmazonRDSFullAccess Policy Document</a> and <a href="https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AmazonVPCFullAccess.html" target="_blank" rel="noopener noreferrer">AmazonVPCFullAccess Policy Document</a>. It will most likely be a subset of the permissions in the policy documents.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-database">Configure Database<a href="#configure-database" class="hash-link" aria-label="Direct link to Configure Database" title="Direct link to Configure Database">‚Äã</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="provision-a-cloud-database">Provision a Cloud Database<a href="#provision-a-cloud-database" class="hash-link" aria-label="Direct link to Provision a Cloud Database" title="Direct link to Provision a Cloud Database">‚Äã</a></h3><p>Assuming the steps in the <a href="#cloud-credentials-and-permissions">Cloud Credentials and Permissions</a> section is setup properly, you can now provision cloud databases via Kusion.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="aws-rds-instance">AWS RDS Instance<a href="#aws-rds-instance" class="hash-link" aria-label="Direct link to AWS RDS Instance" title="Direct link to AWS RDS Instance">‚Äã</a></h4><p>To provision an AWS RDS instance with MySQL v5.7:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;aws&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        engine: &quot;MySQL&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        version: &quot;5.7&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        size: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instanceType: &quot;db.t3.micro&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        securityIPs = [&quot;0.0.0.0/0&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It&#x27;s highly recommended to replace <code>0.0.0.0/0</code> and closely manage the whitelist of IPs that can access the database for security purposes. The <code>0.0.0.0/0</code> in the example above or if <code>securityIPs</code> is omitted altogether will allow connections from anywhere which would typically be a security bad practice.</p><p>The supported <code>engine</code> values are <code>MySQL</code>, <code>MariaDB</code>, <code>Postgres</code> and <code>SQLServer-SE</code>. </p><p>The supported engine versions can be found in:</p><ul><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/MySQL.Concepts.VersionMgmt.html" target="_blank" rel="noopener noreferrer">MySQL versions</a></li><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/MariaDB.Concepts.VersionMgmt.html#MariaDB.Concepts.VersionMgmt.Supported" target="_blank" rel="noopener noreferrer">MariaDB versions</a></li><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_PostgreSQL.html#PostgreSQL.Concepts.General.DBVersions" target="_blank" rel="noopener noreferrer">PostgreSQL versions</a></li><li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_SQLServer.html#SQLServer.Concepts.General.VersionSupport" target="_blank" rel="noopener noreferrer">Microsoft SQL Server versions</a></li></ul><p>The <code>instanceType</code> field determines the computation and memory capacity of the RDS instance. The <code>db.t3.micro</code> instance type in the example above represents the <code>db.t3</code> instance class with a size of <code>micro</code>. In the same <code>db.t3</code> instance family there are also <code>db.t3.small</code>, <code>db.t3.medium</code>, <code>db.t3.2xlarge</code>, etc.</p><p>The full list of supported <code>instanceType</code> values can be found <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.DBInstanceClass.html#Concepts.DBInstanceClass.Support" target="_blank" rel="noopener noreferrer">here</a>.</p><p>You can also adjust the storage capacity for the database instance by changing the <code>size</code> field which is storage size measured in gigabytes. The minimum is 20. More details can be found <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_Storage.html#Concepts.Storage.GeneralSSD" target="_blank" rel="noopener noreferrer">here</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="alicloud-rds-instance">AliCloud RDS Instance<a href="#alicloud-rds-instance" class="hash-link" aria-label="Direct link to AliCloud RDS Instance" title="Direct link to AliCloud RDS Instance">‚Äã</a></h4><p>To provision an AWS RDS instance with MySQL v5.7. AliCloud RDS has several additional fields such as <code>category</code>, <code>subnetID</code> and <code>privateRouting</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;alicloud&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        engine: &quot;MySQL&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        version: &quot;8.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        size: 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instanceType: &quot;mysql.n2.serverless.1cc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        category = &quot;serverless_basic&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        subnetID = &quot;{your-alicloud-vswitch-id}&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        securityIPs = [&quot;0.0.0.0/0&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        privateRouting = False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We will walkthrough <code>subnetID</code> and <code>privateRouting</code> in the <a href="#configure-network-access">Configure Network Access</a> section.</p><p>The supported <code>engine</code> values are <code>MySQL</code>, <code>MariaDB</code>, <code>PostgreSQL</code> and <code>SQLServer</code>. </p><p>The supported engine versions can be found in:</p><ul><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-mysql/major-version-lifecycle-description" target="_blank" rel="noopener noreferrer">MySQL versions</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/developer-reference/api-rds-2014-08-15-createdbinstance" target="_blank" rel="noopener noreferrer">MariaDB versions</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-postgresql/lifecycles-of-major-engine-versions" target="_blank" rel="noopener noreferrer">PostgreSQL versions</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-sql-server/release-notes-for-minor-engine-versions-of-apsaradb-rds-for-sql-server" target="_blank" rel="noopener noreferrer">Microsoft SQL Server versions</a></li></ul><p>A summarized version can be found <a href="https://www.alibabacloud.com/help/en/rds/developer-reference/api-rds-2014-08-15-createdbinstance" target="_blank" rel="noopener noreferrer">here</a> in the <code>EngineVersion</code> parameter.</p><p>The full list of supported <code>instanceType</code> values can be found in:</p><ul><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-mysql/primary-apsaradb-rds-for-mysql-instance-types#concept-2096487" target="_blank" rel="noopener noreferrer">MySQL instance types(x86)</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-mariadb/instance-types#concept-2096591" target="_blank" rel="noopener noreferrer">MariaDB instance types</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-postgresql/primary-apsaradb-rds-for-postgresql-instance-types#concept-2096578" target="_blank" rel="noopener noreferrer">PostgreSQL instance types</a></li><li><a href="https://www.alibabacloud.com/help/en/rds/apsaradb-rds-for-sql-server/primary-apsaradb-rds-for-sql-server-instance-types#concept-2096545" target="_blank" rel="noopener noreferrer">Microsoft SQL Server instance types</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="local-database">Local Database<a href="#local-database" class="hash-link" aria-label="Direct link to Local Database" title="Direct link to Local Database">‚Äã</a></h3><p>To deploy a local database with MySQL v8.0:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        engine: &quot;MySQL&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        version: &quot;8.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        instanceType: &quot;local&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The supported <code>engine</code> values are <code>MySQL</code> and <code>MariaDB</code> as of version 0.9.0. Kusion will stand up a <code>mysql</code> deployment and expose it as a service in the local Kubernetes cluster for local workloads to connect to.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="database-credentials">Database Credentials<a href="#database-credentials" class="hash-link" aria-label="Direct link to Database Credentials" title="Direct link to Database Credentials">‚Äã</a></h2><p>There is no need to manage the database credentials manually. Kusion will automatically generate a random password, set it as the credential when creating the database, and then inject the hostname, username and password into the application runtime.</p><p>You have the option to BYO (Bring Your Own) username for the database credential by specifying the <code>username</code> attribute in the <code>database</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        username: &quot;my_username&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You cannot bring your own password. The password will always be managed by Kusion automatically.</p><p>The database credentials are injected into the environment variables of the application container. You can access them via the following env vars:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># env | grep KUSION_DB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUSION_DB_HOST=wordpress.xxxxxxxx.us-east-1.rds.amazonaws.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUSION_DB_USERNAME=xxxxxxxxx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KUSION_DB_PASSWORD=xxxxxxxxx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can use these environment variables out of the box. Or most likely, your application might retrieve the connection details from a different set of environment variables. In that case, you can map the kusion environment variables to the ones expected by your application using the <code>$()</code> expression.</p><p>This example below will assign the value of <code>KUSION_DB_HOST</code> into <code>WORDPRESS_DB_HOST</code>, <code>WORDPRESS_DB_USER</code> into <code>WORDPRESS_DB_USER</code>, likewise for <code>KUSION_DB_PASSWORD</code> and <code>WORDPRESS_DB_PASSWORD</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    workload: wl.Service {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        containers: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            wordpress: c.Container {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                image = &quot;wordpress:6.3-apache&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                env: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;WORDPRESS_DB_HOST&quot;: &quot;$(KUSION_DB_HOST)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;WORDPRESS_DB_USER&quot;: &quot;$(KUSION_DB_USERNAME)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;WORDPRESS_DB_PASSWORD&quot;: &quot;$(KUSION_DB_PASSWORD)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="configure-network-access">Configure Network Access<a href="#configure-network-access" class="hash-link" aria-label="Direct link to Configure Network Access" title="Direct link to Configure Network Access">‚Äã</a></h2><p>You can also optionally configure the network access to the database as part of the <code>AppConfiguration</code>. This is highly recommended because it dramatically increases the security posture of your cloud environment in the means of least privilege principle.</p><p>The <code>securityIPs</code> field in the <code>Database</code> schema declares the list of network addresses that are allowed to access the database. The network addresses are in the <a href="https://aws.amazon.com/what-is/cidr/" target="_blank" rel="noopener noreferrer">CIDR notation</a> and can be either a private IP range (<a href="https://datatracker.ietf.org/doc/html/rfc1918" target="_blank" rel="noopener noreferrer">RFC-1918</a> and <a href="https://datatracker.ietf.org/doc/html/rfc6598" target="_blank" rel="noopener noreferrer">RFC-6598</a> address) or a public one.</p><p>If the database need to be accessed from a public location (which should most likely not be the case in a production environment), <code>securityIPs</code> need to include the public IP address of the traffic source (For instance, if the RDS database needs to be accessed from your computer).</p><p>To configure AWS RDS to restrict network access from a VPC with a CIDR of <code>10.0.1.0/24</code> and a public IP of <code>103.192.227.125</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;aws&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        securityIPs = [&quot;10.0.1.0/24&quot;, &quot;103.192.227.125/32&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Depending on the cloud provider, the default behavior of the database firewall settings may differ if omitted.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="subnet-id">Subnet ID<a href="#subnet-id" class="hash-link" aria-label="Direct link to Subnet ID" title="Direct link to Subnet ID">‚Äã</a></h3><p>On AWS, you have the option to launch the RDS instance inside a specific VPC if a <code>subnetID</code> is present in the application configuration. By default, if <code>subnetID</code> is not provided, the RDS will be created in the default VPC for that account. However, the recommendation is to self-manage your VPCs to provider better isolation from a network security perspective.</p><p>On AliCloud, the <code>subnetID</code> is required. The concept of subnet maps to VSwitch in AliCloud.</p><p>To place the RDS instance into a specific VPC on AWS:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;aws&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        subnetID: &quot;subnet-xxxxxxxxxxxxxxxx&quot; # replace it with your vpc subnet ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="private-routing">Private Routing<a href="#private-routing" class="hash-link" aria-label="Direct link to Private Routing" title="Direct link to Private Routing">‚Äã</a></h3><p>There is an option to enforce private routing on certain cloud providers if both the workload and the database are running on the cloud.</p><p>On AliCloud, you can set the <code>privateRouting</code> flag to <code>True</code>. The database host generated will be a private FQDN that is only resolvable and accessible from within the AliCloud VPCs. Setting <code>privateRouting</code> flag to <code>True</code> when <code>type</code> is <code>aws</code> is a no-op.</p><p>To enforce private routing on AliCloud:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wordpress: ac.AppConfiguration {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    database: db.Database {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        type: &quot;alicloud&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        privateRouting: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Kusion will then generate a private FQDN and inject it into the application runtime as the environment variable <code>KUSION_DB_HOST</code> for the application to use. A complete list of Kusion-managed environment variable can be found <a href="/zh/docs/v0.9/reference/model/naming-conventions#list-of-magic-variables">here</a>.</p><p>Otherwise when using the public FQDN to connect to a database from the workload, the route will depend on cloud provider&#x27;s routing preference. The options are generally either:</p><ul><li>Travel as far as possible on the cloud provider&#x27;s global backbone network, or also referred to as cold potato routing, or</li><li>Egress as early as possible to the public Internet and re-enter the cloud provider&#x27;s datacenter later, or also referred to as hot potato routing</li></ul><p>The prior generally has better performance but is also more expensive.</p><p>You can find a good read on the <a href="https://aws.amazon.com/blogs/architecture/internet-routing-and-traffic-engineering/" target="_blank" rel="noopener noreferrer">AWS Blog</a> or the <a href="https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/routing-preference-overview" target="_blank" rel="noopener noreferrer">Microsoft Learn</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/KusionStack/kusionstack.io/blob/main/docs_versioned_docs/version-v0.9/config-walkthrough/database.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-09-30T07:02:05.000Z">2024Âπ¥9Êúà30Êó•</time></b> by <b>liu-hm19</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/docs/v0.9/config-walkthrough/networking"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Application Networking</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/docs/v0.9/config-walkthrough/secret"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Secret Management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#import" class="table-of-contents__link toc-highlight">Import</a></li><li><a href="#types-of-database-offerings" class="table-of-contents__link toc-highlight">Types of Database offerings</a></li><li><a href="#cloud-credentials-and-permissions" class="table-of-contents__link toc-highlight">Cloud Credentials and Permissions</a></li><li><a href="#configure-database" class="table-of-contents__link toc-highlight">Configure Database</a><ul><li><a href="#provision-a-cloud-database" class="table-of-contents__link toc-highlight">Provision a Cloud Database</a></li><li><a href="#local-database" class="table-of-contents__link toc-highlight">Local Database</a></li></ul></li><li><a href="#database-credentials" class="table-of-contents__link toc-highlight">Database Credentials</a></li><li><a href="#configure-network-access" class="table-of-contents__link toc-highlight">Configure Network Access</a><ul><li><a href="#subnet-id" class="table-of-contents__link toc-highlight">Subnet ID</a></li><li><a href="#private-routing" class="table-of-contents__link toc-highlight">Private Routing</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Document</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/docs">Kusion</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/karpor/">Karpor</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/kuperator/introduction/">Kuperator</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/ctrlmesh/intro/">CtrlMesh</a></li></ul></div><div class="col footer__col"><div class="footer__title">Resource</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.kusionstack.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/KusionStack" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/kusionstack/shared_invite/zt-19lqcc3a9-_kTNwagaT5qwBE~my5Lnxg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kcl-lang.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">KCL</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.antgroup.com/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/zh/img/oss_logo.svg" alt="AntGroup Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="160" height="51"><img src="/zh/img/oss_logo.svg" alt="AntGroup Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="160" height="51"></a></div><div class="footer__copyright">Copyright ¬© 2024 KusionStack Authors</div></div></div></footer></div>
<script src="/zh/assets/js/runtime~main.76b4a9bd.js"></script>
<script src="/zh/assets/js/main.6623170c.js"></script>
</body>
</html>